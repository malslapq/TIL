# μ¤ν”„λ§ μμ΅΄μ„± μ£Όμ… DI (Dependency Injection)

 μλ°” ν”„λ΅μ νΈλ¥Ό λ§λ“¤λ©΄μ„ λκΌλ μ μ€ MVC ν¨ν„΄μ„ λ§λ“¤μ–΄λ„ μ„λΉ„μ¤ λ μ΄μ–΄μ—μ„ λ§λ“¤μ–΄ λ†“μ€ μΈν„°νμ΄μ¤μ κµ¬ν„μ²΄λ¥Ό μ–΄λ–¤κ±Έλ΅ μ‚¬μ©ν• μ§€ μ •ν•΄μ¤μ•Ό ν–λ‹¤.
κ·Έλ¬λ‹¤ λ³΄λ‹ **μ„λ΅κ°„μ κ°•ν• κ²°ν•©μ„ μ΄λ£¨κ³ , μ–΄λ”κ°€μ—μ„ μμ •μ΄ ν•„μ”ν• κ²½μ° ν•λ‚ν•λ‚ μ½”λ“λ¥Ό λ”°λΌκ°€λ©΄μ„ μ „μ²΄μ μΈ μμ •μ΄ λ¶κ°€ν”Όν–λ‹¤.**

    μ¤ν”„λ§μ„ μ‚¬μ©ν•  λ• λ‚΄κ°€ μ–΄λ–¤ κ²ƒμ„ μ‚¬μ©ν• μ§€ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ—μ„ λ‚΄κ°€ μ„¤μ •ν•΄λ†“μ€ νμΌμ„ μ½μ–΄ μ£Όμ…ν•΄μ¤€λ‹¤λ©΄ μ–΄λ–»κ² λ κΉ?
    
π λ¨μ–‘κ³Ό π λ¨μ–‘μ μ ¤λ¦¬κ°€ μλ‹¤κ³  μƒκ°ν•μ. λ‘ μ ¤λ¦¬λ¥Ό λ§λ“λ” μ¬λ£μ™€ μ–‘μ€ κ°™κ³  λ¨μ–‘λ§ λ‹¤λ¥Ό λΏμ΄λ‹¤.<br>
μ΄λ΄ κ²½μ° λ§λ“λ” κ³Όμ • μ „μ²΄λ¥Ό λ°”κΎΈλ”κ² μ•„λ‹κ³  λ§λ“λ” λ¨μ–‘μ ν‹€λ§ λ°”κΏ”μ£Όλ©΄ λμ§€ μ•μ„κΉ? 

μ΄λ¥Ό Spring DIλΌκ³  μƒκ°ν•λ‹¤λ©΄ μ°λ¦¬κ°€ μ–΄λ–¤ κ°μ²΄(ν‹€)λ¥Ό μ‚¬μ©ν• μ§€λ” Springμ΄ μ°λ¦¬κ°€ λ§λ“¤μ–΄λ†“μ€ μ„¤μ •νμΌμ„ μ½μ€ ν›„ μ΄ κ°μ²΄λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•λ”κµ¬λ‚ ν•κ³  μλ™μ μΌλ΅ μ£Όμ…ν•λ‹¤. 

κ·Έλ¬λ©΄ μ°λ¦¬λ” μ „μ²΄μ μΌλ΅ μ½”λ“λ¥Ό μμ • ν•  ν•„μ”κ°€ μ—†μ–΄μ§€λ” μ—„μ²­λ‚ ν¨κ³Όλ¥Ό μ–»μ„ μ μλ‹¤!!!

### Spring DIλ¥Ό μ‚¬μ©ν•λ” μ΄μ 

- κ²°ν•©λ„λ¥Ό λ‚®μ¶°μ¤€λ‹¤.
- μ¬μ‚¬μ©μ„±, ν™•μ¥μ„±, μ μ—°μ„±μ„ λ†’μ—¬μ¤€λ‹¤.
- ν…μ¤νΈλ¥Ό ν•κΈ° μ©μ΄ν•λ‹¤.

### DI μ‹μ‘ν•κΈ°

- DIλ¥Ό μ„ν•΄μ„λ” ApplicationContextκ°€ κ΄€λ¦¬ν•λ„λ΅ κ°μ²΄λ¥Ό BeanμΌλ΅ λ“±λ΅ν•΄μ•Ό ν•λ‹¤. (μΈν„°νμ΄μ¤λ¥Ό implements ν• classλ“¤μ— @Component μ–΄λ…Έν…μ΄μ…μ„ λ‹¬μ•„μ¤μ•Ό ν•¨ )
  - BeanμΌλ΅λ§ λ“±λ΅ν•  κ²½μ° ν•΄λ‹Ή λ©”μ†λ“κ°€ Bean nameμ΄ λ¨ 
- DIμ—λ” ν•„λ“ μ£Όμ…, setterμ£Όμ…, μƒμ„±μ μ£Όμ…μ΄ μμ§€λ§ μΌλ°μ μΌλ΅ 3κ° μ¤‘ μƒμ„±μ μ£Όμ…μ„ μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤κ³  ν•λ‹¤.

### Code

- config classλ¥Ό μƒμ„±ν•΄ μ–΄λ–¤ κ°μ²΄λ¥Ό μ‚¬μ©ν• μ§€ μ„¤μ •
  - config classμ— `@ComponentScan(basePakages = "com.test.jelly")` μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•΄ ν¨ν‚¤μ§€λ¥Ό μ¤μΊ”ν•λ” λ°©λ²•
  - config classμ— `@ComponentScan(basePakageClasses = "JellyApllication.class")` μ–΄λ…Έν…μ΄μ…μ„ μ΄μ©ν•΄ ν΄λμ¤λ¥Ό μ¤μΊ”ν•λ” λ°©λ²•
  - xmlμ— μ‘μ„±ν•λ” λ°©λ²•λ„ μμ§€λ§ classμμ²΄μ— μ„¤μ •ν•΄μ£Όλ” κ²ƒμ΄ κ°€λ…μ„±μ΄ λ” μΆ‹λ‹¤κ³  μƒκ°ν•κΈ°μ— μ„¤λ…ν•μ§€ μ•κ² μ
- κµ¬ν„μ²΄κ°€ μ—¬λ¬κ°μΌ κ²½μ°
  - μ‚¬μ©ν•  κ°μ²΄ classμ— `@Primary` μ–΄λ…Έν…μ΄μ…μ„ λ‹¬μ•„μ£Όλ” λ°©λ²•
  - μƒμ„±μλ΅ λ°›μ„ λ• `@Qualifier()` μ–΄λ…Έν…μ΄μ…μ„ λ‹¬μ•„μ£Όλ” λ°©λ²•  

```java
@Configuration
public class ApplicationConfig {

    @Bean
    public JellyService JellyService() {
        return new JellyService(new OrangeFrame());
    }

    @Bean
    public OrangeFrame orangeFrame() {
        return new OrangeFrame();
    }

    @Bean
    public AppleFrame appleFrame() {
        return new AppleFrame();
    }

}
```

- μ„¤μ •ν•΄λ†“μ€ κ°μ²΄λ¥Ό μλ™μΌλ΅ μ£Όμ…

```java
@Service
public class JellyService {
    
//    @Autowired    ν•„λ“ μ£Όμ…
    private final JellyFrame jellyFrame;

//    @Autowired    setter μ£Όμ…
    public void setJellyFrame(JellyFrame jellyFrame) {
        this.jellyFrame = jellyFrame;
    }
    
//    @Autowired    μƒμ„±μ μ£Όμ…
    public JellyService(
//            @Qualifier("orangeFrame") κµ¬ν„μ²΄κ°€ μ—¬λ¬κ°μΌ κ²½μ°
            JellyFrame jellyFrame) {
        this.jellyFrame = jellyFrame;
    }

}
```

### νΉμ • ν™κ²½μ—μ„λ§ λ™μ‘ν•κ² ν•κΈ° @Profile

- μ‹¤ν–‰/λ””λ²„κ·Έ κµ¬μ„±μ ν™κ²½λ³€μμ— -Dspring.profiles.active="@Profileλ…"μ„ μ¶”κ°€ν•΄μ•Ό ν•λ‹¤.
  - ν‘ν„μ‹μΌλ΅ !, &, || ν‘ν„ κ°€λ¥ν•λ‹¤. 
- ν΄λμ¤ λ‹¨μ„
  - `
    @Configuration
    @Profile("test")
    `
  - `
    @Component
    @Profile("test")
    `
- λ©”μ†λ“ λ‹¨μ„
  - `
    @Bean
    @Profile("test")
    `

#### μ°Έκ³ 
Lombokμ„ μ‚¬μ©ν•  λ• classμ— `@RequiredArgsConstructor` μ–΄λ…Έν…μ΄μ…μ„ λ‹¬ κ²½μ° ν•΄λ‹Ή class λ‚΄ `final` λλ” `@NonNull` ν•„λ“μ— λ€ν•΄μ„ μƒμ„±μλ¥Ό μƒμ„±ν•΄μ¤€λ‹¤.
μ΄λ΅μ¨ μ°λ¦¬κ°€ μ–»μ„ μ μλ” κ²ƒμ€ ν•΄λ‹Ή classμ— μƒμ„±μκ°€ ν•λ‚λ§ μ΅΄μ¬ν•κ³  μƒμ„±μμ νλΌλ―Έν„° νƒ€μ…μ΄ λΉμΌλ΅ λ“±λ΅ κ°€λ¥ν• κ²½μ° `@Autowired`μ—†μ΄λ„ μμ΅΄μ„± μ£Όμ…μ΄ κ°€λ¥ν•κΈ° λ–„λ¬Έμ— μƒν™©μ— λ§λ”λ‹¤λ©΄
`@RequiredArgsConstructor`μ–΄λ…Έν…μ΄μ… ν•λ‚λ΅ κ°„λ‹¨ν•κ² DIλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.